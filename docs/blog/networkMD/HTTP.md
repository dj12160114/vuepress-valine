# HTTP

## 1. 概述

### 1.1 基本概念

+ 超文本传输协议：传输诸如HTML文档的 **应用层** 协议。
+ 应用于 **Web浏览器与Web服务器** 之间的通信。
+ **无状态**协议，意味着不会在两个请求之间保留任何数据（状态）。
+ 通常基于 **TCP/IP** 层，但可以在任何可靠的传输层上使用。

### 1.2 基于HTTP的组件系统

+ **客户端**：user-agent就是任何能够为用户发起行为的工具，通常为浏览器。

+ **Web服务端**是由Web Server来服务并提供客户端所请求的文档。Server只是虚拟意义上代表一个机器：它可以是共享负载（负载均衡）的一组服务器组成的计算机集群，也可以是一种复杂的软件。

+ **代理（Proxies）**：代理可以表现得透明，也可以不透明（“改变请求”会通过它们），其功能就是代理网络用户去取得网络信息。

  + 作用：缓存、过滤、负载均衡、认证、日志记录。

  + 它的工作主要在 OSI 模型的对话层。

### 1.3 基本性质

+ `简单快速`
+ `灵活`：HTTP允许传输任意类型的数据对象。正在传输的类型由Content-Type加以标记。
+ `可扩展的`：HTTP headers 让协议扩展变得非常容易。只要服务端和客户端在新的headers上语义达成一致，新的功能就可以轻松地被加进来。
+ `无连接`：无连接是限制每次连接只能处理一个请求。服务器处理完客户的请求，并收到客户的应答后，就断开连接。
+ `无状态的，有会话的`：协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传。
  + 无状态的：同一个连接中两个执行成功的请求之间是没有关系的。
  + Cookies可以创建有状态的会话。

## 2. HTTP 报文

HTTP/1.1以及更早的HTTP协议报文都是语义可读的，HTTP/2中，这些报文被嵌入二进制结构——帧。帧能实现报文头部的压缩和复用。

### 2.1 HTTP报文类型

HTTP报文类型分为：**请求和响应**。

#### (1) 请求 Request

**a**. 请求由以下元素组成：

+ 一个HTTP的 **method**，通常由一个动词如 `GET`, `POST `或一个名词如 `OPTIONS`，`HEAD` 来定义客户端的动作行为。

  通常客户端的操作都是获取资源（GET方法）或者发送HTML form表单（POST方法）。

+ 获取资源的 **路径（path）**，通常是上下文中就很明显的元素资源的URL，它没有protocol（http: //），domain（developer.mozilla.org），或是TCP的port（HTTP一般在80端口）。
+ HTTP **协议版本号（version of protocol）**。
+ 为服务器表达其他信息的**可选头部headers**。
+ 对于像POST这样的方法，报文的body就包含了发送的资源，这与响应报文的body类似。

**b**. 例子：

![1567941293805](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1567941293805.png)

#### (2) 响应 Response

**a.** 响应由以下元素组成：

+ HTTP**协议版本号**。
+ 一个**状态码（status code）**，来告知对应请求执行成功或失败，以及失败的原因。
+ 一个**状态信息**，这个信息是非权威的状态码描述信息，可以由服务端自行设定。
+ HTTP **headers**，与请求报文类似。
+ 可选项，比起请求报文，响应报文更常见地包含获取的资源body。

**b. **例子：

![1567941645714](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1567941645714.png)

## 3. HTTP 工作过程

一次 HTTP 操作称为一个事务，其工作整个过程如下：

+ **地址解析**
  + 解析出协议名、主机名、端口、对象路径；
  + 在这一步，需要域名系统 DNS 解析域名，得到主机的 IP 地址。
+ **封装HTTP请求数据包**
  + 把以上部分结合本机自己的信息封装成一个 HTTP 请求数据包

+ **封装TCP包，建立TCP连接（三次握手）**

  + 在HTTP工作开始之前，客户机（Web浏览器）首先要通过网络与服务器建立连接，该连接是通过TCP来完成的。

+ **客户机发送请求命令**

+ **服务器响应**

  +  实体消息是服务器向浏览器发送头信息后，它会发送一个空白行来表示头信息的发送到此结束，接着，它就以Content-Type应答头信息所描述的格式发送用户所请求的实际数据

+ **服务器关闭TCP连接**

  + 一般情况下，一旦Web服务器向浏览器发送了请求数据，它就要关闭TCP连接，然后如果浏览器或者服务器在其头信息加入了这行代码：

    Connection:keep-alive

    TCP连接在发送后将仍然保持打开状态，于是，浏览器可以继续通过相同的连接发送请求。保持连接节省了为每个请求建立新连接所需的时间，还节约了网络带宽。

    

## 2. HTTPS

### 2.1 含义

是以安全为目标的HTTP通道，简单讲是HTTP的安全版。即HTTP下加入SSL层，HTTPS的安全基础是SSL，因此加密的详细内容就需要SSL。 HTTPS存在不同于HTTP的默认端口及一个加密/身份验证层（在HTTP与TCP之间）。

### 2.2 HTTPS的作用

一种是建立一个信息安全通道，来保证数据传输的安全；另一种就是确认网站的真实性。

### 2.3 HTTP 与 HTTPS区别

+ `https` 协议需要 CA证书，费用较高
+ `http` 是超文本传输协议，信息是明文传输，`https` 则是具有安全性的 SSL 加密传输协议。
+ 使用不同的连接方式，端口也不同，一般而言，`http` 是80端口，`https` 是443端口。
+ `http` 的连接很简单，是无状态的；`https` 协议是由 `SSL` + `HTTP` 协议构建的可进行加密传输、身份认证的网络协议，比 `http` 协议安全。

![img](https://pics6.baidu.com/feed/d53f8794a4c27d1e5a06f37fdcdc2b6addc43873.jpeg?token=4a5c7783f60db50158a4f4b03aab052b&s=58281C7283CA454B0EE5F1CB0000A0B2)